<app-header></app-header>

<div class="container-fluid bgpad">
    <div class="row">
        <div class="products-container">
            <div class="products-header">
                <h1>Discover</h1>
            </div>

            <div class="category-section">
                <div class="category-list">
                    <button *ngFor="let category of categories" class="category-btn"
                        [class.active]="selectedCategory?.id === category.id" (click)="selectCategory(category)">
                        <span class="category-name">{{ category.name }}</span>
                    </button>
                </div>
                <button class="add-product-btn" (click)="openAddProductModal()">
                    <span class="plus-icon">
                        <img src="../../../assets/add-square-04.png">
                    </span>
                    Add Product
                </button>
            </div>

            <div class="subcategory-section">
                <div class="subcategory-tabs" *ngIf="subcategories.length > 0">
                    <button *ngFor="let subcategory of subcategories" class="subcategory-tab"
                        [class.active]="selectedSubcategory?.id === subcategory.id"
                        (click)="selectSubcategory(subcategory)">
                        {{ subcategory.name }}
                    </button>
                </div>
                <div class="subcategory-tabs" *ngIf="subcategories.length === 0">
                    <button class="subcategory-tab  text-center text-black">
                       <span style="text-align: center;"> No subcategories</span>
                    </button>
                </div>

                <div class="search-section">
                    <input type="text" placeholder="Search your product" [(ngModel)]="searchTerm"
                        (ngModelChange)="onSearchChange($event)" class="search-input">
                    <div class="search-icon">üîç</div>
                </div>

                <div class="table-wrapper">
                    <div class="table-scroll-container">
                        <table class="products-table">
                            <thead>
                                <tr>
                                    <th>No.</th>
                                    <th>Product</th>
                                    <th>Sub Category</th>
                                    <th>Created Date</th>
                                    <th>Order</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let product of products; let i = index">
                                    <td>{{ ((pagination.currentPage || 1) - 1) * (pagination.pageSize || 10) + i + 1 }}
                                    </td>

                                    <td>
                                        <div class="product-cell">
                                            <img class="product-image" alt="product"
                                                [src]="product.productImagesList?.[0] ? baseUrl + product.productImagesList[0] : 'assets/no-image.png'" />

                                            <span>{{ product.productName }}</span>
                                        </div>
                                    </td>

                                    <td>{{ product.subCategoryName }}</td>

                                    <td>
                                        {{ product.timestamp ? formatDate23(product.timestamp) : '-' }}
                                    </td>

                                    <td>{{ product.stockQuantity }}</td>

                                    <td>
                                        <div class="actions ms-auto">
                                            <img src="../../../assets/editimg.png" (click)="editProduct(product)"
                                                class="action-icon">
                                            <img src="../../../assets/deleteimg.png"
                                                (click)="deleteProduct(product)" class="action-icon">
                                        </div>
                                    </td>
                                </tr>
                            </tbody>

                        </table>

                        <div *ngIf="products.length === 0" class="no-products">
                            <p>No products found</p>
                        </div>
                    </div>
                </div>

                <div class="pagination-section">
                    <button class="pagination-btn prev-btn" [disabled]="pagination.currentPage === 1"
                        (click)="previousPage()">
                        ‚Üê Previous
                    </button>

                    <div class="page-numbers">
                        <button *ngFor="let pageNum of getPageNumbers()" [class.active]="isPageActive(pageNum)"
                            class="page-btn" (click)="goToPage(pageNum)">
                            {{ pageNum }}
                        </button>

                        <span class="page-dots"
                            *ngIf="getPageNumbers()[getPageNumbers().length - 1] < pagination.totalPages">
                            ....
                        </span>

                        <button *ngIf="getPageNumbers()[getPageNumbers().length - 1] < pagination.totalPages"
                            class="page-btn" (click)="goToPage(pagination.totalPages)">
                            {{ pagination.totalPages }}
                        </button>
                    </div>

                    <button class="pagination-btn next-btn"
                        [disabled]="pagination.currentPage === pagination.totalPages" (click)="nextPage()">
                        Next ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>